---
title: unplugin-vue-components分析之代码注入
date: 2022-09-21 14:21:44
permalink: /pages/dae6d7/
categories:
  - 技术
  - webpack
tags:
  - 
---

unplugin系列插件对于解决代码冗余，解放生产力都是个不错的选择。

unplugin-vue-components能够减少频繁而不必要的引入，从而减少工作量。这么好的插件，让我们看看它的实现细节吧！

:::tip
该文章需要webpack的基础知识，强烈推荐阅读使用后，再来看此文章。不必了解的特别深入，对于复杂的地方会做简单说明。
:::

## 实现思路

我们希望webpack可以在编译的时候，通过在sfc中找到为引入组件的标签，如`<custome-component />`。找到后，动态的添加一个对应的组件引用到`<script>`的开头。

这样就无需专注后续引入和解析的问题，把复杂的问题交给webpack去处理。

再来按步骤分析一下：

1. 对所有vue文件继进行遍历，找到没有引用但实际使用的组件tag。
2. 针对组件tag再指定文件中寻找相应组件，有则引入，无则不处理。

乍一看，问题似乎没有难度。但请思考以下问题：

1. 如何在webpack中修改源代码？或者说什么时机修改源代码？
2. webpack是解析