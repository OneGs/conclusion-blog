---
title: 各种类型的预览处理
date: 2023-02-27 19:47:22
permalink: /pages/a43cc9/
categories:
  - 技术
  - 问题解决方案
tags:
  - 
---

# 各种类型的预览处理

常见的类型有，图片、pdf、word文档、相关专业特有文件（如CAD）。

在预览过程中，常常出现预览格式不统一、调用不一致等问题，造成项目混乱，显得很廉价。

为解决这个问题，可以通过一个集成方案统一调度。在这里，服务式dialog可以发挥举足轻重的作用。

## 图片预览

图片预览是所有预览中最常见、最简单但也是最容易出现混乱的类型。

默认情况下，html本身就支持图片预览。也有很多第三方组件库提供了功能更加丰富的预览。

项目内，更多是需要满足客户的定制化内容。一般支持一下功能即可：

1. 支持多个预览图片间的快速切换
2. 支持通过键盘进行操作切换
3. 对不同大小图片预览的良好支持

## pdf预览

1. iframe、embed等元素嵌套：易于实现，兼容性较差
2. pdfJs第三方库：需引入第三方库，兼容性强于iframe，可操作性大
3. 由后台转为pdf进行显示：易于实现，兼容性最好，需要和后端交互，交互好坏取决于网络速度

## world和excel预览

在项目内，world和excel的预览常常伴随着对文件的操作。

目前，world想要操作需要使用付费的第三方插件。为此在web中出现了一个替代方案：富文本。

如果只要预览：

1. 免费纯前端方式实现在线预览word、excel、ppt最优选择微软在线预览（不可编辑）
2. 类似pdf将文件转化为图片然后展示（不可编辑）

不只预览：world用富文本替换

1. 富文本存在一些开源的第三方库，但不够完善，使用成本较大。如WangEditor等
2. excel则可以使用SheetJs、Luckysheet等
3. 第三方付费的插件，有较好的支持，使用成本会较低，开发成本变高

## 专业文件

此类文件需要专业工具的帮助。

一般而言，公司会有专门的部门对该文件进行解析翻译成html文件用于展示。

专业文件的可操作性完全取决于公司该部门对该技术的支持。

而我们只需要做好配合即可。