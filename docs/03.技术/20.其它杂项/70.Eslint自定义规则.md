---
title: Eslintè‡ªå®šä¹‰è§„åˆ™
date: 2023-02-20 19:02:47
permalink: /pages/72c857/
categories:
  - æŠ€æœ¯
  - å…¶å®ƒæ‚é¡¹
tags:
  - 
---

# Eslintè‡ªå®šä¹‰è§„åˆ™

eslintæ˜¯ä»£ç è§„èŒƒå·¥å…·ï¼Œèƒ½å¤Ÿå®æ—¶æ£€æµ‹ä»£ç å­˜åœ¨çš„æ ·å¼é”™è¯¯ã€‚è®©ä»£ç æ ·å¼åŒ–ã€ç»Ÿä¸€åŒ–ï¼Œæé«˜è¯­ä¹‰æ€§ã€å¯è¯»æ€§ã€‚

eslinté»˜è®¤æä¾›äº†å¾ˆå¤šruleæ¥è§„èŒƒä»£ç ï¼ŒåŒæ—¶ä¹Ÿæœ‰ä¸°å¯Œå¤šå½©çš„ç¬¬ä¸‰æ–¹ruleä¸æ–­åŠ å…¥åˆ°å¤§çš„ç”Ÿæ€ä¸­æ¥ã€‚

ä½†æˆ–å¤šæˆ–å°‘ï¼Œå®ƒä»¬å¹¶ä¸èƒ½100%çš„è§£å†³åœ¨å¼€å‘ä¸­æ‰€é‡åˆ°çš„å®šåˆ¶åŒ–é—®é¢˜ã€‚å¦‚ï¼Œè¡¨æ ¼å­—æ®µçš„æŒ‰ç…§ä¸€å®šçš„é¡ºåºæ’åˆ—ï¼ˆäººã€çŠ¶æ€ã€å•ä½ã€ç»„ç»‡ã€æ—¶é—´ï¼‰ã€
æŸä¸€åˆ—å­—æ®µå±äºå¿…å¡«é¡¹ï¼Œä½†æœªä½œå¿…å¡«æ ¡éªŒã€‚

åœ¨åºå¤§çš„é¡¹ç›®ä¸­ï¼Œé€šè¿‡äººå·¥æ‰‹åŠ¨åœ°æ£€æŸ¥ï¼Œä¿®æ”¹ï¼Œæ— ç–‘æ˜¯ä¸€é¡¹è€—æ—¶ã€è€—åŠ›çš„å·¥ä½œï¼ŒåŒæ—¶æ— æ³•ä¿è¯å®Œæ•´çš„æ’æŸ¥å®Œæ¯•ã€‚

ä¸ºæ­¤ï¼Œé€šè¿‡å®šåˆ¶åŒ–çš„eslint ruleæ›¿æˆ‘ä»¬æ£€æŸ¥å‡ºé—®é¢˜ï¼Œåœ¨ç¼–å†™çš„è¿‡ç¨‹ä¸­å³å¯é¿å…é—®é¢˜ã€‚åˆ©ç”¨fixæ›´èƒ½ä¸€é”®ä¿®å¤ï¼Œä½•ä¹è€Œä¸ä¸ºå‘¢ã€‚

å¼€å‘eslint ruleå‰ï¼Œä½ éœ€è¦çŸ¥é“eslintæ˜¯å¦‚ä½•é…ç½®ã€ä½¿ç”¨çš„ï¼å¦‚æœä¸æ¸…æ¥šè¯·å…ˆé˜…è¯»[å®˜æ–¹æ–‡æ¡£](https://eslint.org/docs/latest/use/getting-started)ã€‚

é‚£ä¹ˆè®©æˆ‘ä»¬å‡†å¤‡å¼€å§‹å§ã€‚æŒ‰ç…§çŸ¥è¯†ç‚¹å¤§è‡´åˆ—ä¸€ä¸‹çš„å¤§çº²ï¼š
1. ASTæ˜¯ä»€ä¹ˆï¼Œæˆ‘ä»¬æ€ä¹ˆä¿®æ”¹å®ƒï¼Ÿ
2. eslint ruleçš„åˆ›å»ºã€æµ‹è¯•å’Œè¿ç”¨ï¼
3. eslintæ˜¯å¦‚ä½•ä¿®å¤ä»£ç çš„ï¼Ÿ

<!-- more -->

## ASTæ˜¯ä»€ä¹ˆï¼Œæˆ‘ä»¬æ€ä¹ˆä¿®æ”¹å®ƒï¼Ÿ

å’±ä¸å»è°ˆä»€ä¹ˆè¯æ³•è§£æã€è¯­æ³•è§£æç­‰ç‰›é€¼è¯è¯­ï¼Œç›´æ¥äº†å½“çš„è§£é‡Šã€‚

å¯¹äºæ–°æ‰‹è€Œè¨€ï¼ŒASTå°±æ˜¯ä¸€å¥—å·¥å…·ï¼Œèƒ½å¤Ÿå°†ä¸€ä¸²stringè½¬åŒ–æˆç±»ä¼¼Dom Treeçš„nodeæ ‘ï¼Œç„¶åä½ å¯ä»¥æ“ä½œè¿™æ£µæ ‘è¿›è¡Œæ·»åŠ ã€åˆ é™¤ã€æ›¿æ¢ç­‰æ“ä½œï¼Œ
æœ€åå†ä»nodeæ ‘è½¬åŒ–æˆstringäº¤ç»™jsæ‰§è¡Œã€‚

å†ç®€å•ç‚¹ï¼šASTå…è®¸å¯¹ä»£ç è¿›è¡Œæ“ä½œå¹¶æ‰§è¡Œã€‚

æœ‰ä»€ä¹ˆä½œç”¨ï¼Ÿæˆ‘ä»¬æ•²ä»£ç ä¸å°±æ˜¯åœ¨åšè¿™ç§äº‹æƒ…ï¼Ÿå½“ç„¶æ˜¯æ‰¹é‡å¯¹ä»£ç è¿›è¡Œä¿®æ”¹å•¦ï¼Œè¿™æ ·å°±ä¸éœ€è¦ç¨‹åºå‘˜è‹¦è‹¦çš„æ‰‹åŠ¨å»ä¿®æ”¹é‡å¤æ€§ä»£ç äº†ï¼Œå¤šå¥½å•Šã€‚

ç½‘ä¸Šæœç´¢äº†å¥½å¤šASTç›¸å…³çš„çŸ¥è¯†ï¼Œå…¨éƒ¨éƒ½æ˜¯ä»‹ç»ASTæ˜¯å•¥çš„ï¼Ÿå…·ä½“æ€ä¹ˆä½¿ç”¨è¿˜æ˜¯ä¸€å¤´é›¾æ°´ï¼Ÿåªèƒ½è¯´ç°åœ¨å¤§å®¶æ›´å¤šå…³æ³¨çš„æ˜¯å®ƒæ˜¯ä»€ä¹ˆï¼Œè€Œä¸å»è¯´å®ƒè¦æ€ä¹ˆåšï¼

å¥½å§ï¼Œé‚£è®©æˆ‘ä»¬æ¥è¡¥ä¸ŠæŠŠï¼š

### å¦‚ä½•æ“ä½œASTï¼Ÿ

æ—¢ç„¶çŸ¥é“äº†ASTæ˜¯ä¸€ä¸ªå·¥å…·ï¼Œé‚£ä¹ˆå°±å»æŠŠå·¥å…·æ‰¾å‡ºæ¥ã€‚

æ€ä¹ˆæœå‘¢ï¼Ÿ

ç›´æ¥è¾“å…¥ï¼šjs astï¼Ÿå¥½åƒä¸è¡Œï¼Œå…¨æ˜¯ä»‹ç»ASTæ˜¯ä»€ä¹ˆï¼Œå†å¤šç‚¹å°±æ˜¯å‘Šè¯‰ä½ åˆ©ç”¨babelå¯ä»¥åšä»£ç è½¬æ¢ã€‚

![img_1.png](./img_1.png)

è¾“å…¥ï¼šastæœ‰å“ªäº›è½¬æ¢å™¨ï¼Ÿè¿˜æ˜¯ä¸è¡Œå•Šï¼Œå…¨æ˜¯æ–­æ–­ç»­ç»­çš„å†…å®¹ã€‚

![img.png](./img.png)

å¥½å§ã€‚é‚£è®©å’±æ¥ä»‹ç»ä¸€ä¸‹å§ã€‚

å’±ä¹‹å‰è¯´ï¼Œastå…¶å®å°±æ˜¯ä¸€ä¸ªå·¥å…·ï¼Œè¿™ä¸ªå·¥å…·çš„åå­—ä¸“ä¸šç‚¹å«åšè§£æå™¨ã€‚åœ¨æ–‡ç« ä¸­ï¼Œå¸¸èƒ½çœ‹åˆ°äººæ‹¿babelæ¥è¯´äº‹ã€‚

babelåœ¨è¿™é‡Œå°±å«åšè§£æå™¨ã€‚ä½†è§£æå™¨æ˜¯å¦åªæœ‰è¿™ä¸€ç§å‘¢ï¼Ÿå½“ç„¶ä¸æ˜¯ï¼Œåœ¨eslintçš„configæ–‡ç« ä¸­èƒ½çœ‹åˆ°å¦‚ä¸‹ä¸€å¥è¯ï¼š

![img_2.png](./img_2.png)

> By default, ESLint uses Espree as its parser. You can optionally specify that a different parser should be used in your configuration file if the parser meets the following requirements:

é»˜è®¤åœ°ï¼Œeslintä½¿ç”¨Espreeä½œä¸ºè§£æå™¨ã€‚

å’±å¯ä»¥çŸ¥ï¼šASTè§£æå™¨æœ‰å¾ˆå¤šç§ï¼Œå¯ä»¥å°†å¤šç§ä¸åŒcodeè§£ææˆnode treeã€‚

å¸¸è§çš„ASTè§£æå™¨æœ‰ï¼šï¼ˆå’±è¿™é‡Œè¿˜æœ‰ä¸€ä¸ªå°æŠ€å·§ï¼šåœ¨æµè§ˆå™¨è¾“å…¥æ¡†è¾“å…¥ Espree vsè¯•è¯•ğŸ¤£ï¼‰


1. Espreeï¼šeslinté»˜è®¤ã€‚ 
2. recast: å¸¸è§ã€‚
3. babel/parseï¼šbabelé»˜è®¤ã€‚ 
4. vue-eslint-parserï¼šè§£ævue templateã€‚

å¥½ï¼Œç°åœ¨çŸ¥é“äº†æœ‰å“ªäº›ASTå·¥å…·äº†ï¼Œé€‰ä¸€ä¸ªå¸¸ç”¨çš„recastï¼Œè¿›å…¥[github](https://github.com/benjamn/recast)çœ‹ä¸€ä¸‹ç¤ºä¾‹ï¼š

```javascript
import * as recast from "recast";

// The string code
const code = [
  "function add(a, b) {",
  "  return a +",
  "    // Weird formatting, huh?",
  "    b;",
  "}"
].join("\n");

// parse code
const ast = recast.parse(code);
```

å—¯ï¼å¾ˆç®€å•å˜›ï¼`parse`æ˜¯è§£æï¼Œè¦è½¬å›stringï¼Œç”¨`print`å°±å¥½äº†ã€‚

é‚£è®©å’‹æŠŠå‡½æ•°åæ”¹ä¸º"addPlugs"è¯•è¯•æ‰‹ã€‚

...

è¿™å¯å’‹æ”¹å•Šï¼Œå•¥éƒ½ä¸äº†è§£å•Šï¼ast treeå•¥æ ·éƒ½ä¸çŸ¥é“ï¼Œå’‹åšä¿®æ”¹å‘¢ï¼Ÿ

é‚£å†æ¥çœ‹çœ‹ast treeä¼šå˜æˆä»€ä¹ˆæ ·å­å§ï¼

### AST Treeé•¿ä»€ä¹ˆæ ·ï¼Ÿ

å’±çŸ¥é“ï¼Œastè§£æå™¨å¤šç§å¤šæ ·ï¼Œæ€»ä¸èƒ½è§£æå‡ºæ¥ast treeå…¨éƒ½ä¸åŒï¼Œå’‹ä¸ªå…¼å®¹ä½¿ç”¨å‘¢ï¼Ÿä¸ºæ­¤esæä¾›äº†å…·ä½“çš„æ ‡å‡†ï¼Œä¾›å¤§å®¶å‚è€ƒå®ç°ã€‚

æ‰€ä»¥å¤§è‡´ä¸Šast treeè§£æå‡ºæ¥æ˜¯ç›¸è¿‘çš„ï¼Œé™¤äº†ä¸€äº›è‡ªå®šä¹‰çš„codeã€‚

è¿™é‡Œæ¨èä½¿ç”¨ï¼š[astexplorer](https://astexplorer.net/) åœ¨çº¿è§£æå·¥å…·ï¼Œå¯é€‰æ‹©ä¸åŒè¯­è¨€ï¼Œä¸åŒè§£æå™¨ï¼Œç›´æ¥åœ°å°†è§£æç»“æœæ˜¾ç¤ºåœ¨å³ä¾§ã€‚

![img_3.png](./img_3.png)

å°†ä¸Šè¿°ä»£ç stringç²˜è´´åˆ°å·¦ä¾§ä»£ç åŒºï¼Œç‚¹å‡»åˆ°addä¸Šã€‚å¯ä»¥çœ‹åˆ°å·¦ä¾§ç»“æœä¸ºï¼š

![img_4.png](./img_4.png)

å°è¯•ä¿®æ”¹ä¸€ä¸‹ï¼š

```javascript
import * as recast from "recast";

// The string code
const code = [
    "function add(a, b) {",
    "  return a +",
    "    // Weird formatting, huh?",
    "    b;",
    "}"
].join("\n");

// parse code
const ast = recast.parse(code);
// body[0] è¡¨ç¤ºç¬¬ä¸€ä¸ªé€‰ä¸­çš„å‡½æ•°è¡¨è¾¾å¼
// id ä¸ºæ ‡è¯†ç¬¦
// name ä¸ºæ ‡è¯†ç¬¦åç§°ï¼Œä¿®æ”¹ç›®æ ‡
ast.body[0].id.name = 'addPlus'
console.log(recast.print(ast))
```




