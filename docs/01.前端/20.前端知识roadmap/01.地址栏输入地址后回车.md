---
title: 地址栏输入地址后回车
date: 2022-04-06 14:35:19
permalink: /pages/ba6364/
categories:
  - 前端
  - 前端知识roadmap
tags:
  - 
---
## 地址栏输入地址后回车发生了什么？

大致步骤：
1. DNS域名解析。
2. Http，Tcp建立网络连接。
3. serve收到请求，返回请求所需的数据。
4. 浏览器分析html，解析得到renderTree后，渲染成用户看到的页面。

## DNS域名解析系统

域名特点：
1. 通过 `.` 将域名划分为不同的标号。
2. 每一段标号代表一个分层，层级大小从左往右升序序，最右侧的标号又被叫做 **顶级域名**。
3. www.xxx.com，www为三级域名、xxx为二级域名、com为顶级域名。

核心：
1. 将域名地址解析为网络中唯一的ip地址。
2. 从域名服务器中查找自己需要ip，域名服务器分：根域名服务器、顶级域名服务器、权威域名服务器。
3. 查找策略有两种：递归查询、迭代查询。
4. 域名解析具备缓存功能，即DNS服务器会对最近查过域名在本地进行保存，下次请求无需向上级查询。
5. 查询过程：本地（浏览器）DNS -> 权威DNS -> 顶级DNS -> 根DNS，同时配合策略查找。

## 网络连接和发送

Http2.0协议特点：
1. 无状态、支持长连接。
2. 报文分为：行（请求行、状态行），头部（请求头、响应头）、体。

TCP/IP5层协议：
1. 物理层：在物理层面为数据的传输提供通道。无论物理媒介如何改变，都为上层协议提供了一个完美的无需改动的传输通道。
2. 数据链路层：保证数据在临近节点之间的安全、稳定的传输。（数据的稳定传输）
3. 网络层：选择合适的路由完成数据运输，负责在两个分组网之间的通信。（哪条路方便快捷）
4. 传输层：负责两台主机进程之间的通信，主要有TCP和UDP两种协议。（哪个程序之间在通信）
5. 应用层：网络应用程序能够使用网络服务传输自己的特殊数据。（程序的信息需要通过独有的结构传输）

核心：
1. 数据通过http协议转为http报文。
2. [tcp三次握手建立连接。](../30.计算机网络/01.TCP的三次握手和四次挥手.md)
3. serve接收请求，根据需求返回数据。
4. client收到响应数据，四次挥手断开连接。
5. client开始解析数据并渲染。

## 浏览器工作原理

1. 解析html为tokens，再将tokens转化为node，最终获得nodeTree。
2. 解析过程中遇到css资源，dom解析被阻塞直到cssTree构建成功。
3. [解析过程中遇到js资源，dom解析被阻塞直到js加载并执行完成。js的加载流程可以通过字段控制。](./02.js的加载机制之defer和async.md)
4. 解析过程中遇到得其它资源，如图片、字体等，采用异步加载方案，不会阻塞html解析。
5. cssTree和domTree都完成后，两者会合并为renderTree。此时一些视觉属性已经存在。
6. 通过layout或reflow计算出每个节点的位置、大小。
7. paint渲染到页面，用户可见。

---

:tada: 至此，用户输入url回车后，浏览器的大致流程就梳理清楚了。
